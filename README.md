
Time limit script for computers
-------------------------------

This project includes a batch file, a PowerShell script, C#, and a Visual Basic script designed to control how long a computer can be used each day. It is a free alternative to expensive commercial programs for children, schools, or companies. Although it is still under development and works on Windows 10, the .exe file will be blocked on Windows 11 due to Windows security settings. You can either switch it off or wait for the fully functional program, or use it for educational purposes.

Scripting Languages Used
------------------------

C# file (MainProgram.exe) is a compiled program that runs the batch file automatically without needing the user to do anything. I have also included MainProgram.cs for educational purposes if anyone would be interested in exploring it further.

Batchfile (DailyUsageLimit.bat) is used to set up and control the execution flow of the time restriction logic.

PowerShell - The file (ShowTimedMessage.ps1) script displays notifications and handles advanced logic.

Visual Basic - The file (MinimizeWindow.vbc)  uses Visual Basic scripting to integrate and run the batch file seamlessly without user intervention.


What this does
--------------

Monitors how long the computer has been used and ensures it doesn't exceed the set limit (default is one hour per day).

Displays messages on the screen informing users how long they have left before the computer logs them off or shuts down.

You can easily adjust the time limits or change the notification messages.

Generates logs that record detailed script activities, which is useful for diagnosing issues.


How to use it
-------------

1. Download the project
   
   
2. Modify the scripts if necessary
   	Adjust the `DailyUsageLimit.bat` and `ShowTimedMessage.ps1` files according to your needs.

3. Set up the batch script in Task Scheduler
   	Schedule the `MinimizeWindow.vbc` file to run at user login or at specific times using Windows Task Scheduler.


Setting up the task in Task Scheduler
-------------------------------------

To ensure the batch file runs automatically, follow these steps to create a new task in Windows Task Scheduler:

1. Open Task Scheduler: Search for Task Scheduler in the Start menu or type `taskschd.msc` in the Run dialogue.
2. Create a new task: Go to the Action menu and select 'Create Task'.
3. General tab: Provide a name and description for the task. Choose 'Run whether the user is logged on' and check 'Run with highest privileges'.
4. Triggers tab: Click 'New' and set the trigger to 'At log on' or on a schedule as needed. Make sure it's enabled.
5. Actions tab: Set the action to 'Start a program'. Browse and select your MainProgram.exe file. 
6. Conditions tab: Leave the settings blank to ensure the task works in both AC power and battery operation conditions. If you select the option 'Start the task only if the computer is on AC power,' it will restrict the task to run only when the computer is plugged in, not on battery.
7. Settings tab: Configure how the task should behave if it fails or runs longer than expected.
8. Save the task: Click 'OK' to save your settings. You might need to enter system credentials.


Files and logs
--------------

`usage.log` and `timelog.txt`- These files store data on computer usage times and are created and updated by the batch script.

`script_log.txt`- Automatically generated by the script, this file logs all actions taken by the script, providing a detailed record that helps troubleshoot.

`script_output.txt` - Automatically created to capture messages and errors from PowerShell scripts, helping with troubleshooting and record-keeping.

Handling overly restrictive settings
------------------------------------

If you set a very low time limit by mistake, you can temporarily modify the Task Scheduler settings to bypass the script. Go to the 'Conditions' tab and choose a network condition that is not currently met to prevent the task from running.


Debugging and logs
------------------

The script uses `echo` commands to log operational details to `script_log.txt`, located at `C:\Users\yourusername\Documents\script_log.txt`. This log file is crucial for troubleshooting and verifying script operations.


License
-------

This project is freely available for use under the MIT License.
